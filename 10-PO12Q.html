<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 10 ‚Äì PO12Q: Introduction to Quantitative Political Analysis II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11-Downloads.html" rel="next">
<link href="./09-PO12Q.html" rel="prev">
<link href="./images/favicon-32.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e2851886d12d134ff83effd9cfa02285.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="theme-color" content="#1d1f2b" media="(prefers-color-scheme: dark)">
<meta name="theme-color" content="#1d1f2b" media="(prefers-color-scheme: light)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<script>
// This MUST come before the script src above
window.MathJax = {
  tex: {
    // (Quarto already sets these, but harmless to repeat)
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]'], ['$$', '$$']]
  },
  // Tell the CHTML output to use Fira
  chtml: { font: 'mathjax-fira' }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-chtml-nofont.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/Crest_white.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><span class="title-long">PO12Q: Introduction to Quantitative Political Analysis II</span> <span class="title-short">PO12Q</span></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://drflolinke.github.io/"> 
<span class="menu-text">Flo‚Äôs Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-PO12Q.html"><span class="chapter-title">Week 10</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-PO12Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-PO12Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-PO12Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-PO12Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-PO12Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-PO12Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 6</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-PO12Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 7</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-PO12Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-PO12Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 9</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-PO12Q.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Week 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Downloads.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Downloads</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Glossary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Full Glossary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-bib.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">List of References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Week 10</h2>
   
  <ul>
  <li><a href="#methods-methods-methods" id="toc-methods-methods-methods" class="nav-link active" data-scroll-target="#methods-methods-methods">Methods, Methods, Methods</a>
  <ul class="collapse">
  <li><a href="#data-prep" id="toc-data-prep" class="nav-link" data-scroll-target="#data-prep">Data Prep</a></li>
  <li><a href="#video-and-rscript" id="toc-video-and-rscript" class="nav-link" data-scroll-target="#video-and-rscript">Video and RScript</a></li>
  </ul></li>
  <li><a href="#road-map-for-today" id="toc-road-map-for-today" class="nav-link" data-scroll-target="#road-map-for-today">Road Map for Today</a></li>
  <li><a href="#self-assessment-questions" id="toc-self-assessment-questions" class="nav-link" data-scroll-target="#self-assessment-questions">Self-Assessment Questions</a></li>
  <li><a href="#multi-collinearity" id="toc-multi-collinearity" class="nav-link" data-scroll-target="#multi-collinearity">(Multi-)Collinearity</a></li>
  <li><a href="#functional-misspecifiation-and-ramseys-reset-test" id="toc-functional-misspecifiation-and-ramseys-reset-test" class="nav-link" data-scroll-target="#functional-misspecifiation-and-ramseys-reset-test">Functional Misspecifiation and Ramsey‚Äôs RESET Test</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#working-with-the-classical-linear-assumptions" id="toc-working-with-the-classical-linear-assumptions" class="nav-link" data-scroll-target="#working-with-the-classical-linear-assumptions">Working with the Classical Linear Assumptions</a>
  <ul class="collapse">
  <li><a href="#how-to-use-the-app" id="toc-how-to-use-the-app" class="nav-link" data-scroll-target="#how-to-use-the-app">How to use the app</a></li>
  <li><a href="#exercises-with-the-app" id="toc-exercises-with-the-app" class="nav-link" data-scroll-target="#exercises-with-the-app">Exercises with the app</a></li>
  </ul></li>
  <li><a href="#testing-the-classical-linear-assumptions-in-r" id="toc-testing-the-classical-linear-assumptions-in-r" class="nav-link" data-scroll-target="#testing-the-classical-linear-assumptions-in-r">Testing the Classical Linear Assumptions in R</a></li>
  <li><a href="#homoscedasticity" id="toc-homoscedasticity" class="nav-link" data-scroll-target="#homoscedasticity">Homoscedasticity</a></li>
  <li><a href="#multi-collinearity-1" id="toc-multi-collinearity-1" class="nav-link" data-scroll-target="#multi-collinearity-1">(Multi-)Collinearity</a></li>
  <li><a href="#solutions" id="toc-solutions" class="nav-link" data-scroll-target="#solutions">Solutions</a></li>
  </ul></li>
  <li><a href="#homework" id="toc-homework" class="nav-link" data-scroll-target="#homework">Homework</a></li>
  <li><a href="#glossary" id="toc-glossary" class="nav-link" data-scroll-target="#glossary">Glossary</a></li>
  <li><a href="#flashcards" id="toc-flashcards" class="nav-link" data-scroll-target="#flashcards">Flashcards</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Week 10</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="methods-methods-methods" class="level1 unnumbered">
<h1 class="unnumbered">Methods, Methods, Methods</h1>
<p>This week we will be testing two of the CLAs, namely homoscedasticity and colinearity. As always, we will use the American National Election Studies (ANES). I will draw on the data set and regression models from Week 8 to assess these assumptions.</p>
<section id="data-prep" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="data-prep">Data Prep</h2>
<p>Place the ANES data in a folder which you will be using as a working directory for this session. Open the ‚ÄúCode for Data Preparation‚Äù below, and copy this into an RScript. Remember to adjust the working directory with the <code>setwd()</code> command at the beginning. Then run the RScript and you will be ready to proceed to the video.</p>
<div class="bluebox">
<details>
<summary>
Code for Data Preparation
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MMM - Week 8 - Data Preparation</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################################</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set WD</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>()</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data set</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>anes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"anes.csv"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of missing values for variables used in analysis today</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 999 is equivalent to NA, so needs to be recoded</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>anes<span class="sc">$</span>fttrump1 <span class="ot">&lt;-</span> <span class="fu">with</span>(anes, <span class="fu">replace</span>(fttrump1, fttrump1 <span class="sc">==</span> <span class="dv">999</span>, <span class="cn">NA</span>)) </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>anes<span class="sc">$</span>income <span class="ot">&lt;-</span> <span class="fu">with</span>(anes, <span class="fu">replace</span>(income, income <span class="sc">==</span> <span class="dv">99</span>, <span class="cn">NA</span>)) </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>anes <span class="ot">&lt;-</span> <span class="fu">filter</span>(anes, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>               <span class="sc">!</span><span class="fu">is.na</span>(fttrump1),</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>               <span class="sc">!</span><span class="fu">is.na</span>(age),</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>               <span class="sc">!</span><span class="fu">is.na</span>(income))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn income variable into a numerical variable with mid-points of each level</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>anes<span class="sc">$</span>income <span class="ot">&lt;-</span> <span class="fu">factor</span>(anes<span class="sc">$</span>income)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(anes<span class="sc">$</span>income)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>anes <span class="ot">&lt;-</span> anes <span class="sc">%&gt;%</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income_fac =</span> <span class="fu">recode</span>(income,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'1'</span><span class="ot">=</span> <span class="st">"2500"</span>,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'2'</span><span class="ot">=</span> <span class="st">"7499.5"</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'3'</span><span class="ot">=</span> <span class="st">"12499.5"</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'4'</span><span class="ot">=</span> <span class="st">"17499.5"</span>,                       </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'5'</span><span class="ot">=</span> <span class="st">"22499.5"</span>,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'6'</span><span class="ot">=</span> <span class="st">"27499.5"</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'7'</span><span class="ot">=</span> <span class="st">"32499.5"</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'8'</span><span class="ot">=</span> <span class="st">"37499.5"</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'9'</span><span class="ot">=</span> <span class="st">"42499.5"</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'10'</span><span class="ot">=</span> <span class="st">"47499.5"</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'11'</span><span class="ot">=</span> <span class="st">"52499.5"</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'12'</span><span class="ot">=</span> <span class="st">"57499.5"</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'13'</span><span class="ot">=</span> <span class="st">"62499.5"</span>,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'14'</span><span class="ot">=</span> <span class="st">"67499.5"</span>,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'15'</span><span class="ot">=</span> <span class="st">"72499.5"</span>,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'16'</span><span class="ot">=</span> <span class="st">"77499.5"</span>,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'17'</span><span class="ot">=</span> <span class="st">"82499.5"</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'18'</span><span class="ot">=</span> <span class="st">"87499.5"</span>,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'19'</span><span class="ot">=</span> <span class="st">"92499.5"</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'20'</span><span class="ot">=</span> <span class="st">"97499.5"</span>,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'21'</span><span class="ot">=</span> <span class="st">"112499.5"</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'22'</span><span class="ot">=</span> <span class="st">"137499.5"</span>,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'23'</span><span class="ot">=</span> <span class="st">"162499.5"</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'24'</span><span class="ot">=</span> <span class="st">"187499.5"</span>,</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'25'</span><span class="ot">=</span> <span class="st">"224999.5"</span>,</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'26'</span><span class="ot">=</span> <span class="st">"500000"</span>))</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>anes<span class="sc">$</span>inc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(anes<span class="sc">$</span>income_fac))</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co"># save data set for use in video</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(anes, <span class="st">"anes_week10.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
</div>
</section>
<section id="video-and-rscript" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="video-and-rscript">Video and RScript</h2>
<p>You can find the video introducing you to this week‚Äôs method by way of a worked example below. You can also access the code I am typing up in the video in the ‚ÄúCode for Data Analysis‚Äù section. I would encourage you to type it yourself, though, as then code tends to better sink into the depths of your brain üòâ</p>
<div class="bluebox">
<details>
<summary>
Code for Data Analysis
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################################</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MMM - Week 10 - BLUE</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################################</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set WD</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data set</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>anes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"anes_week8.csv"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression Models</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="do">############################</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(fttrump1 <span class="sc">~</span> inc, <span class="at">data =</span> anes)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(fttrump1 <span class="sc">~</span> age, <span class="at">data =</span> anes)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(fttrump1 <span class="sc">~</span> inc <span class="sc">+</span> age, <span class="at">data =</span> anes)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing for Homoscedasticity</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="do">################################</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Null Hypothesis: Homoscedasticity</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Alternative: Heteroscedasticity</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(model1)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(model2)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model2, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model2, <span class="at">type=</span><span class="st">"HC3"</span>))</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing for Collinearity</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="do">################################</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
</div>
<div class="video">
<p><strong>Making Your Regression BLUE</strong></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/fWcPSzcSU8M?si=uR9aQOzRXCql1mq5" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</div>
</section>
</section>
<section id="road-map-for-today" class="level1 unnumbered">
<h1 class="unnumbered">Road Map for Today</h1>
<div style="height:2em;">

</div>
<table style="border-collapse: collapse; width: 60%; margin-left: auto; margin-right: auto; table-layout: fixed;">
<tbody>
<tr>
<td style="border-top: 3px double currentColor !important; border-bottom: none !important; padding: 8px;">
Recap: Methods, Methods, Methods
</td>
</tr>
<tr>
<td style="border: none !important; padding: 8px;">
Self-Assessment Questions
</td>
</tr>
<tr>
<td style="border: none !important; padding: 8px;">
(Multi-)Collinearity
</td>
</tr>
<tr>
<td style="border: none !important; padding: 8px;">
Functional Misspecification: Ramsey‚Äôs RESET Test
</td>
</tr>
<tr>
<td style="border-top: 1px dashed currentColor !important; border-bottom: 1px dashed currentColor !important; padding: 8px;">
Break
</td>
</tr>
<tr>
<td style="border: none !important; border-bottom: 3px double currentColor !important; padding: 8px;">
Exercises
</td>
</tr>
</tbody>
</table>
<div style="height:2em;">

</div>
</section>
<section id="self-assessment-questions" class="level1 unnumbered">
<h1 class="unnumbered">Self-Assessment Questions</h1>
<ol type="1">
<li>How do the mathematical properties of OLS (Week 5) differ from the Classical Linear Assumptions?</li>
<li>Why is observed heteroscedasticity a problem that needs addressing?</li>
<li>What happens in a model with (multi-)collinearity?</li>
<li>Does the assumption of linearity in the Gauss-Markov Theorem preclude non-linear transformations? Why / why not?</li>
</ol>
<div class="stop">
<p>Please stop here and don‚Äôt go beyond this point until we have compared notes on your answers.</p>
</div>
</section>
<section id="multi-collinearity" class="level1 unnumbered">
<h1 class="unnumbered">(Multi-)Collinearity<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></h1>
<p>I have shown you in the lecture how (multi-)collinearity affects our OLS estimates. In the worksheet below, we are going to test for it. We can do so with correlation analysis, which assesses to what degree two variables vary together. As such, this method is limited to pairwise comparisons between variables. It is conceivable, and indeed often the case, however, that one variable is functionally related to two or more other independent variables, such as</p>
<p><span class="math display">\[\begin{equation*}
    x_{1,i} = 0.2 x_{2,i }- 1.7 x_{3,i}
\end{equation*}\]</span></p>
<p>We refer to this situation as multicollinearity. In order to detect it, we need to test for the functional dependence of each independent variable on the remaining independent variables in the model. We can do so by employing secondary regression models, not unlike in the Breusch-Pagan Test (see lecture slides). We specify K secondary regression models, each adopting one of our K independent variables as its dependent variable. Let us specify such a function for <span class="math inline">\(x_1\)</span>:</p>
<p><span class="math display">\[\begin{equation*}
x_{1,i} = \alpha_0 + \alpha_1 x_{2,i} + \alpha_2 x_{3,i} + ... + \alpha_{k-1} x_{k,i} + v_i
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> denotes our new regression coefficients, and <span class="math inline">\(v_i\)</span> represents a random error term. For the remaining independent variables, the functions would look as follows:</p>
<p><span class="math display">\[\begin{align*}
    x_{2,i} &amp;= \alpha_0 + \alpha_1 x_{1,i} + \alpha_2 x_{3,i} + \alpha_3 x_{4,i} + ... + \alpha_{k-1} x_{k,i} + v_i \\
    x_{3,i} &amp;= \alpha_0 + \alpha_1 x_{1,i} + \alpha_2 x_{2,i} + \alpha_3 x_{4,i} + ... + \alpha_{k-1} x_{k,i} + v_i \\
    \vdots \\
    x_{k,i} &amp;= \alpha_0 + \alpha_1 x_{1,i} + \alpha_2 x_{2,i} + \alpha_3 x_{3,i} + ... + \alpha_{k-1} x_{k-1,i} + v_i
\end{align*}\]</span></p>
<p>In order to quantify how well each of the K regression functions explains the respective independent variable, we are going to use Adjusted R-Squared. We will note the <span class="math inline">\(\bar{R}^2\)</span> of each individual regression as <span class="math inline">\(\bar{R}_j^2\)</span> where j runs from 1 to k, or <span class="math inline">\(j=1,...,k\)</span>.</p>
<p><span class="math inline">\(\bar{R}_j^2\)</span> in itself already provides useful information, but we can do better than this. We can use <span class="math inline">\(\bar{R}_j^2\)</span> to develop a measure which tells us how much larger the observed variance of a coefficient is compared to a scenario in which the variable was totally functionally independent from the other independent variables in the model. We call this measure <strong>variance inflation factor</strong> and define it as follows:</p>
<p><span class="math display">\[\begin{equation}
\text{VIF}_j = \frac{1}{1-\bar{R}_j^2}
\end{equation}\]</span></p>
<p>Its size is solely determined by <span class="math inline">\(\bar{R}_j^2\)</span>. The better a model explains the respective independent variable, the closer <span class="math inline">\(\bar{R}_j^2\)</span> will be to one, increasing the size of VIF<span class="math inline">\(_j\)</span>. A commonly adopted threshold for classing a variable as (multi-)collinear is either VIF=5, or VIF=10. These thresholds are completely arbitrary, but have nonetheless managed to establish themselves in regression analysis.</p>
</section>
<section id="functional-misspecifiation-and-ramseys-reset-test" class="level1 unnumbered">
<h1 class="unnumbered">Functional Misspecifiation and Ramsey‚Äôs RESET Test</h1>
<p>The Classical Linear Model (CLA) assumes that the conditional expectation of <span class="math inline">\(y\)</span> is a linear function of the independent variables, i.e.&nbsp;</p>
<p><span class="math display">\[\begin{equation*}
E[y_i \mid x_{1,i}, x_{2,i}, \dots, x_{k,i}]
= \beta_0 + \beta_1 x_{1,i} + \beta_2 x_{2,i} + \dots + \beta_k x_{k,i}
\end{equation*}\]</span></p>
<p>This does not mean that <span class="math inline">\(y\)</span> itself must be linear in the variables, but rather that our specified regression function correctly captures the systematic part of the relationship between <span class="math inline">\(y\)</span> and the independent variables. If the true relationship is nonlinear in ways not represented by our chosen functional form (for example, quadratic or interaction terms are missing), then the linearity assumption is violated.</p>
<p>Ramsey‚Äôs Regression Specification Error Test (RESET) provides a convenient way to detect such misspecifications. The idea is simple: if our original model is well specified, then adding nonlinear combinations of the fitted values <span class="math inline">\(\hat{y}\)</span> should not significantly increase explanatory power. If they do, this suggests that some nonlinear transformations of the independent variables are missing.</p>
<p>To implement the test, we take the fitted values <span class="math inline">\(\hat{y}_i\)</span> from our original regression model and augment the specification with their higher-order terms, such as <span class="math inline">\(\hat{y}_i^2\)</span>, <span class="math inline">\(\hat{y}_i^3\)</span>, and so on. A simple example would be</p>
<p><span class="math display">\[\begin{equation*}
y_i = \beta_0 + \beta_1 x_{1,i} + \beta_2 x_{2,i} + \gamma_1 \hat{y}_i^2 + \gamma_2 \hat{y}_i^3 + u_i
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_1\)</span> and <span class="math inline">\(\gamma_2\)</span> are the new regression coefficients associated with the nonlinear transformations of the fitted values.</p>
<p>But what does it actually mean to square <span class="math inline">\(\hat{y}\)</span>? Recall that <span class="math inline">\(\hat{y}\)</span> is itself a linear combination of the independent variables:</p>
<p><span class="math display">\[\begin{equation*}
\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_{1,i} + \hat{\beta}_2 x_{2,i}
\end{equation*}\]</span></p>
<p>For simplicity, let us consider only two independent variables. Squaring <span class="math inline">\(\hat{y}\)</span> yields</p>
<p><span class="math display">\[\begin{equation*}
\hat{y}_i^2 = (\hat{\beta}_0 + \hat{\beta}_1 x_{1,i} + \hat{\beta}_2 x_{2,i})^2
\end{equation*}\]</span></p>
<p>Expanding the square gives us</p>
<p><span class="math display">\[\begin{equation*}
\hat{y}_i^2 = \hat{\beta}_0^2
+ 2\hat{\beta}_0 \hat{\beta}_1 x_{1,i}
+ 2\hat{\beta}_0 \hat{\beta}_2 x_{2,i}
+ \hat{\beta}_1^2 x_{1,i}^2
+ 2\hat{\beta}_1 \hat{\beta}_2 x_{1,i}x_{2,i}
+ \hat{\beta}_2^2 x_{2,i}^2
\end{equation*}\]</span></p>
<p>Here you can see that squaring <span class="math inline">\(\hat{y}\)</span> introduces (i) quadratic terms such as <span class="math inline">\(x_{1,i}^2\)</span> and <span class="math inline">\(x_{2,i}^2\)</span>, and (ii) interaction terms such as <span class="math inline">\(x_{1,i}x_{2,i}\)</span>. Cubing <span class="math inline">\(\hat{y}\)</span> would in turn generate cubic terms and triple interactions, and so forth.</p>
<p>This is the party trick of the RESET test: by including powers of the fitted values, we are indirectly testing whether higher-order polynomials and interactions of the independent variables explain additional variation in <span class="math inline">\(y\)</span>. If they do, it implies that our initial specification left out relevant nonlinear structure.</p>
<p>The RESET test then proceeds by conducting a joint hypothesis test:</p>
<p><span class="math display">\[\begin{equation*}
H_0: \gamma_1 = \gamma_2 = ... = 0
\end{equation*}\]</span></p>
<p>This is carried out as a so-called F-test. An F-test is a statistical test that compares how well two models fit the data by checking whether the improvement in fit from adding extra terms is large enough to be unlikely due to chance.</p>
<p>It is useful to distinguish this broad RESET-style F-test from more targeted checks. For example, we might compare a linear model directly with a quadratic model by adding only <span class="math inline">\(x^2\)</span> as an extra term. That F-test answers the very specific question: ‚Äúdoes a quadratic term improve the fit?‚Äù. By contrast, the RESET F-test adds powers of the fitted values (e.g.&nbsp;<span class="math inline">\(\hat{y}^2\)</span>, <span class="math inline">\(\hat{y}^3\)</span>), which implicitly include a wide range of squared and interaction terms. It therefore serves as a comprehensive test for functional misspecification, but comes with the downside that it won‚Äôt tell us which particular nonlinear component is missing ‚Äì a bit like R refusing to run a script, but not telling you where you missed that elusive comma or bracket. I have therefore included both variants in the app below.</p>
<p>Rejection of <span class="math inline">\(H_0\)</span> indicates that at least one nonlinear transformation contributes to explaining <span class="math inline">\(y\)</span>, and hence that our original model suffers from functional misspecification. Failure to reject <span class="math inline">\(H_0\)</span> suggests no evidence against the original specification. So it‚Äôs best to think of this test as a check that tells us when we should take another look at the theoretical foundations of our model specification (see Week 9).</p>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<section id="working-with-the-classical-linear-assumptions" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="working-with-the-classical-linear-assumptions">Working with the Classical Linear Assumptions</h2>
<p>To help you understand the assumptions, I have written <a href="https://drflolinke.github.io/shinylive/reg_assumptions/">an app</a> which illustrates how violations of key OLS regression assumptions affect estimation and inference.</p>
<p>You start by simulating a base dataset. In a second step, you apply one of these three common assumption violations:</p>
<ul>
<li>Nonlinearity: the true relationship includes a quadratic term, but the fitted model is linear.<br>
</li>
<li>Heteroskedasticity: the error variance increases with <span class="math inline">\(x\)</span>, so residuals spread out unevenly.<br>
</li>
<li>Collinearity: predictors <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are highly correlated, making coefficient estimates unstable.</li>
</ul>
<section id="how-to-use-the-app" class="level3">
<h3 class="anchored" data-anchor-id="how-to-use-the-app">How to use the app</h3>
<ol type="1">
<li>Choose the <code>sample size</code> and the true coefficients (<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>) in the left panel.<br>
</li>
<li>Click <code>Simulate data</code> to generate the base dataset.<br>
</li>
<li>Select a <code>violation scenario</code> and adjust its sliders to control severity.<br>
</li>
<li>The <code>main plot</code> shows the data, fitted line(s), and diagnostic curves.<br>
</li>
<li>The <code>Diagnostics box</code> reports statistical checks such as Breusch‚ÄìPagan, RESET, or VIF, depending on the scenario.<br>
</li>
<li>The <code>Model comparison</code> box contrasts the fitted equation with and without the violation.</li>
</ol>
<p>You can reset everything with the <code>Reset</code> button and repeat with different settings to see how results vary.</p>
</section>
<section id="exercises-with-the-app" class="level3">
<h3 class="anchored" data-anchor-id="exercises-with-the-app">Exercises with the app</h3>
<ol type="1">
<li><strong>Base fit</strong><br>
Click <code>Simulate data</code> with the scenario set to <code>Base (no violation)</code>.
<ol type="a">
<li>What is the fitted line shown at the top of the plot?<br>
</li>
<li>Is the estimated slope <span class="math inline">\(\hat\beta_1\)</span> close to the ‚ÄúTrue <span class="math inline">\(\beta_1\)</span>‚Äù you set in the left panel? Briefly explain why it won‚Äôt be exactly equal.</li>
</ol></li>
<li><strong>Heteroskedasticity on/off</strong><br>
Switch to <code>Heteroscedasticity</code> and set the slider to <code>0</code>.
<ol type="a">
<li>What happens to the Breusch‚ÄìPagan (approx) p-value?<br>
</li>
<li>Increase the slider until a clear ‚Äúbowtie‚Äù pattern appears. How do the <code>SE (OLS)</code> and <code>SE (HC3)</code> compare for the slope, and which p-value (OLS vs HC3) is more conservative?</li>
</ol></li>
<li><strong>Reading the bowtie guide</strong><br>
With heteroskedasticity turned up (non-zero), the dashed guide labeled ‚ÄúError spread (<span class="math inline">\(\sigma\)</span>)‚Äù is plotted.
<ol type="a">
<li>What does this curve represent in relation to <span class="math inline">\(x\)</span>?<br>
</li>
<li>How does this relate to the Breusch‚ÄìPagan result you see in the diagnostics?</li>
</ol></li>
<li><strong>Functional form: keeping the same sample</strong><br>
Switch to <code>Nonlinearity (functional form)</code>.
<ol type="a">
<li>Set <span class="math inline">\(\beta_2=0\)</span>. What should the scatter and linear fit look like relative to the base sample?<br>
</li>
<li>Increase <span class="math inline">\(\beta_2\)</span> (positive). What visual change do you see, and what happens to the <code>Linear vs quadratic (F-test)</code> p-value?<br>
</li>
<li>If you set <span class="math inline">\(\beta_2&lt;0\)</span>, how does the shape change and how should the RESET-style p-value respond?</li>
</ol></li>
<li><strong>Comparing linear vs quadratic coefficients</strong><br>
In the <code>Nonlinearity</code> diagnostics, inspect the table for the quadratic fit.
<ol type="a">
<li>Which coefficient corresponds to curvature?<br>
</li>
<li>When does it become statistically significant, and how does this align with the F-test and the overlayed dashed quadratic curve?</li>
</ol></li>
<li><strong>Multicollinearity: creating instability</strong><br>
Switch to <code>Collinearity (multivariate)</code>.
<ol type="a">
<li>Increase <span class="math inline">\(\rho_{x}\)</span> close to 1. What happens to the VIF values in the diagnostics?<br>
</li>
<li>In the <code>Model output</code> pane, compare the estimate of <span class="math inline">\(\beta_1\)</span> ‚Äúboth <span class="math inline">\(x_1\)</span> &amp; <span class="math inline">\(x_2\)</span>‚Äù vs ‚Äúonly <span class="math inline">\(x_1\)</span>‚Äù. What does this illustrate about coefficient instability?<br>
</li>
<li>Why does collinearity mainly affect inference (SEs, stability) rather than introducing systematic bias?</li>
</ol></li>
<li><strong>Equation comparison panel</strong><br>
With each scenario, read the <code>Model comparison</code> block (bottom-right card).
<ol type="a">
<li>For <code>Nonlinearity</code>, why does the card display <span class="math inline">\(\hat y_{\text{linear}}=\hat\beta_0+\hat\beta_1 x\)</span> instead of the quadratic?<br>
</li>
<li>For <code>Collinearity</code>, how is the model equation written, and what does that tell you about interpretation of <span class="math inline">\(\hat\beta_{x_1}\)</span> and <span class="math inline">\(\hat\beta_{x_2}\)</span>?</li>
</ol></li>
</ol>
</section>
</section>
<section id="testing-the-classical-linear-assumptions-in-r" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="testing-the-classical-linear-assumptions-in-r">Testing the Classical Linear Assumptions in R</h2>
<p>For this worksheet we will be using the <code>london</code> data set from the lectures, this time with the following variables:</p>
<p>&nbsp;</p>
<div class="custom-html-table">
<div class="cell">
<div id="tbl-londoncode10" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-londoncode10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 85%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Label</th>
<th style="text-align: left;">Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: left;">Parliamentary constituency</td>
<td style="text-align: left;">n/a</td>
</tr>
<tr class="even">
<td style="text-align: left;">gcse</td>
<td style="text-align: left;">An average score based on a pupil‚Äôs best eight grades in a group of GCSEs. The maximum a pupil can achieve is 90 points</td>
<td style="text-align: left;">2019</td>
</tr>
<tr class="odd">
<td style="text-align: left;">houseprice</td>
<td style="text-align: left;">Median house price, average across four quarters, in GBP</td>
<td style="text-align: left;">2019</td>
</tr>
<tr class="even">
<td style="text-align: left;">idaci</td>
<td style="text-align: left;">The Income Deprivation Affecting Children Index rank - how it compares to other constituencies</td>
<td style="text-align: left;">2015/2016</td>
</tr>
<tr class="odd">
<td style="text-align: left;">income</td>
<td style="text-align: left;">Mean income by constituency</td>
<td style="text-align: left;">2017/18</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-londoncode10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Codebook for <code>london_11</code> Data Set
</figcaption>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Data are taken from <span class="citation" data-cites="gov:2013">GOV.UK (2013)</span>, <span class="citation" data-cites="london:2010">London Data Store (2010)</span>, and <span class="citation" data-cites="hoc:nd">House of Commons Library (n.d.)</span>.</p>
</section>
<section id="homoscedasticity" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="homoscedasticity">Homoscedasticity</h2>
<ol type="1">
<li>Load the data set <a href="files/Week 10/london_11.csv">london_11.csv</a> as an object called <code>london</code></li>
<li>Subset the data to a random sample as follows:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>london_sam <span class="ot">&lt;-</span> <span class="fu">sample_frac</span>(london, <span class="fl">0.65</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Regress GCSE scores on <code>income</code> and interpret the results.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(gcse <span class="sc">~</span> income, <span class="at">data=</span>london_sam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Breusch-Pagan Test by Hand
<ol type="a">
<li>Extract the residuals from model 1 and store their squared values in a new object called <code>ressq</code>.</li>
</ol></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ressq <span class="ot">&lt;-</span> <span class="fu">resid</span>(model1)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b. Regress the squared residuals on the original independent variable.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>model1res <span class="ot">&lt;-</span> <span class="fu">lm</span>(ressq<span class="sc">~</span>income, <span class="at">data=</span>london_sam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Store the number of observations of this new model in an object called <code>N</code>.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model1res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Obtain the model fit measure R<span class="math inline">\(^2\)</span> for this model.</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e. Calculate the test-statistic for the Breusch-Pagan test as the product of <code>N</code> and R<span class="math inline">\(^2\)</span>.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>chisq <span class="ot">&lt;-</span> <span class="fl">0.001857</span><span class="sc">*</span>N</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Conduct a Chi-Squared test with one degree of freedom.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(chisq, <span class="at">df=</span><span class="dv">1</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7676653</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Breusch-Pagan Test with the <code>lmtest</code> package.
<ol type="a">
<li>Install and load the <code>lmtest</code> package</li>
</ol></li>
</ol>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b. Call</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Compare the results with the results obtained in Exercise 4f.</div>
<ol start="6" type="1">
<li>Heteroscedasticity
<ol type="a">
<li>Now let‚Äôs introduce heteroscedasticity:</li>
</ol></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>london_heterosc <span class="ot">&lt;-</span> <span class="fu">filter</span>(london, income<span class="sc">&lt;</span><span class="dv">28000</span> <span class="sc">|</span> income<span class="sc">&gt;</span><span class="dv">100000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="puzzle">
<p>Why does this code lead to heteroscedasticity?</p>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b. Estimate a new model, and note the significance of coefficients.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(gcse <span class="sc">~</span> income, <span class="at">data=</span>london_heterosc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Conduct a Breusch-Pagan Test with the <code>lmtest</code> package.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Install and load the <code>sandwich</code> package.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e. The <code>sandwich</code> package replaces <span class="math inline">\(\Omega\)</span> with a new diagonal which takes into account</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heteroscedasticity. The default is <code>HC3</code> ‚Äì if you ever work with somebody using Stata then</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;you need to replace this with <code>HC1</code> to obtain the same results. Conduct a significance test with</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;robust standard errors (with the <code>sandwich</code> function <code>coeftest</code>):</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model2, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model2, <span class="at">type=</span><span class="st">"HC3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Compare the significance to the results in 6b and explain the reason for the difference.</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g. Estimate a model of your own choice with <code>gcse</code> as your dependent variable.</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h. Conduct the Breusch-Pagan test</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i. by hand</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii. with the <code>lmtest</code> package</div>
</section>
<section id="multi-collinearity-1" class="level2">
<h2 class="anchored" data-anchor-id="multi-collinearity-1">(Multi-)Collinearity</h2>
<p>For these exercises use the <code>london_sam</code> data frame.</p>
<ol type="1">
<li>Regress GCSE scores on and in a multiple regression model. Interpret the results.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(gcse <span class="sc">~</span> income <span class="sc">+</span> idaci, <span class="at">data=</span>london_sam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Install and load the package.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Calculate the Variance Inflation Factor (VIF) for this model as follows:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Interpret the results.</li>
<li>Regress GCSE scores on <code>houseprice</code>. Store the results in an object called <code>model4</code>. Note the significance of the slope coefficient and interpret the results.</li>
<li>Let‚Äôs introduce some collinearity by estimating the following model:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(gcse <span class="sc">~</span> income <span class="sc">+</span> houseprice, <span class="at">data=</span>london_sam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" type="1">
<li>Calculate the VIF for model 5. Interpret the results.</li>
<li>Drawing on the results of Exercise 7, explain the significance of the slope coefficients of Model 1 (Exercise 3 in the previous section) and Model 4 (Exercise 6 of this section).</li>
</ol>
</section>
<section id="solutions" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="solutions">Solutions</h2>
<p>You can find the Solutions in the <a href="https://drflolinke.github.io/PO12Q/11-Downloads.html">Downloads Section</a>.</p>
</section>
</section>
<section id="homework" class="level1 unnumbered">
<h1 class="unnumbered">Homework</h1>
<ul>
<li>Work through <a href="https://drflolinke.github.io/PO12Q/10-PO12Q.html#flashcards">this week‚Äôs flashcards</a> to familiarise yourself with the relevant R functions.</li>
<li>Complete the <a href="https://moodle.warwick.ac.uk/mod/quiz/view.php?id=2436166">Week 10 Moodle Quiz</a></li>
<li>There will be an exam revision session in Week 2 of term 3. For this, please complete the <a href="files/Week 10/PO12Q_Week-10_Case-Study.pdf">Sample Case Study</a></li>
<li>Prepare for the exam in term 3.</li>
</ul>
</section>
<section id="glossary" class="level1 unnumbered">
<h1 class="unnumbered">Glossary</h1>
<p>&nbsp;</p>
<div class="glossary-table">
<div class="cell" data-tbl-colwidths="[25,75]">
<div id="tbl-glossary10" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[25,75]">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-glossary10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="cell table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">autocorrelation</td>
<td style="text-align: left;">The value of one error term does not allow us to predict the value of another error term. As such their covariances must be zero</td>
</tr>
<tr class="even">
<td style="text-align: left;">collinearity</td>
<td style="text-align: left;">If two variables are functionally dependent on each other we call these collinear. Should this apply to multiple variables at the same time we call these multi-collinear. (multi-)collinearity exists if ‚Äì and only if ‚Äì the values follow this function precisely. Such a situation is rare, as usually variables are more loosely related to one another</td>
</tr>
<tr class="odd">
<td style="text-align: left;">covariance</td>
<td style="text-align: left;">A measure which assesses the degree to which the values of two variables (<span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_i\)</span>) vary together (their joint variability).</td>
</tr>
<tr class="even">
<td style="text-align: left;">heteroscedasticity</td>
<td style="text-align: left;">The variability of the error terms changes for different observations <span class="math inline">\(X\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">homoscedasticity</td>
<td style="text-align: left;">Refers to a constant variance of the error terms</td>
</tr>
<tr class="even">
<td style="text-align: left;">law of iterative expectations</td>
<td style="text-align: left;">According to this law, ‚Äúthe expected value of X is equal to the expectationover the conditional expectation of X given Y‚Äù <span class="citation" data-cites="robinson:2022">(Robinson, 2022)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">multicollinearity</td>
<td style="text-align: left;">A situation in which an independent variable is a function of multiple other independent variables in the regression model</td>
</tr>
<tr class="even">
<td style="text-align: left;">omitted variable bias</td>
<td style="text-align: left;">If you omit an important variable in a regression model, it will bias the size of other coefficients if the variables are correlated.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">outer product</td>
<td style="text-align: left;">The outer product of two vectors results in a matrix in which each element is the product of corresponding elements from the first vector (rows) and the second vector (columns).</td>
</tr>
<tr class="even">
<td style="text-align: left;">robust standard errors</td>
<td style="text-align: left;">Also known as Huber-White standard errors, correct for heteroscedasticity by ‚Äú[adjusting] the model-based standard errors using the empirical variability of the model residuals‚Äù <span class="citation" data-cites="mansournia:2020">(Mansournia et al., 2020, p. 347)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">time-series data</td>
<td style="text-align: left;">Time-series data review a certain characteristic over time <span class="math inline">\(t\)</span>, where <span class="math inline">\(t\)</span> runs from 1 to <span class="math inline">\(T\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Variance-Covariance Matrix</td>
<td style="text-align: left;">A variance-covariance matrix is a square matrix that encapsulates the variances of different variables on its diagonal and the covariances between pairs of variables in its off-diagonal elements.&nbsp;</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variance Inflation Factor (VIF)</td>
<td style="text-align: left;">A measure to quantify the how much larger the observed variance of a coefficient is compared to a scenario in which the variable was totally functionally independent from the other independent variables in the model</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-glossary10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Glossary Week 10
</figcaption>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="flashcards" class="level1 unnumbered">
<h1 class="unnumbered">Flashcards</h1>
<div class="flashcard">
<details>
<summary>
New Functions This Week
</summary>
<div style="padding-bottom:56.25%; position:relative; display:block; width: 100%">
<p><iframe width="100%" height="100%" src="files/flashcards/PO12Q_Week 10_New.html" frameborder="0" allowfullscreen="" style="position:absolute; top:0; left: 0"> </iframe></p>
</div>
<p>
&nbsp;
</p>
The data are available as a <a href="files/excelfiles/PO12Q_Week 10_New.csv">.csv file</a>.
</details>
</div>
<div class="flashcard">
<details>
<summary>
R Functions This Week
</summary>
<div style="padding-bottom:56.25%; position:relative; display:block; width: 100%">
<p><iframe width="100%" height="100%" src="files/flashcards/PO12Q_Week 10_All.html" frameborder="0" allowfullscreen="" style="position:absolute; top:0; left: 0"> </iframe></p>
</div>
<p>
&nbsp;
</p>
The data are available as a <a href="files/excelfiles/PO12Q_Week 10_All.csv">.csv file</a>.
</details>
</div>
<div class="flashcard">
<details>
<summary>
All R Functions Used on the Module
</summary>
<div style="padding-bottom:56.25%; position:relative; display:block; width: 100%">
<p><iframe width="100%" height="100%" src="files/flashcards/PO12Q_Week 10_Consolidate.html" frameborder="0" allowfullscreen="" style="position:absolute; top:0; left: 0"> </iframe></p>
</div>
<p>
&nbsp;
</p>
The data are available as a <a href="files/excelfiles/PO12Q_Week 10_Consolidate.csv">.csv file</a>.
</details>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-gov:2013" class="csl-entry" role="listitem">
GOV.UK. (2013). <em><span class="nocase">National Statistics: Income and tax by Parliamentary constituency</span></em>. <a href="https://www.gov.uk/government/statistics/income-and-tax-by-parliamentary-constituency-2010-to-2011">https://www.gov.uk/government/statistics/income-and-tax-by-parliamentary-constituency-2010-to-2011</a>
</div>
<div id="ref-hoc:nd" class="csl-entry" role="listitem">
House of Commons Library. (n.d.). <em><span>Data Dashboard</span></em>. <a href="https://commonslibrary.parliament.uk/type/data-dashboard/">https://commonslibrary.parliament.uk/type/data-dashboard/</a>
</div>
<div id="ref-linke:forthcoming" class="csl-entry" role="listitem">
Linke, F. (forthcoming). <em><span class="nocase">Introduction to Quantitative Methods in the Social Sciences</span></em>. Oxford: Oxford University Press.
</div>
<div id="ref-london:2010" class="csl-entry" role="listitem">
London Data Store. (2010). <em><span>London Parliamentary Constituency Profiles 2010</span></em>. <a href="https://data.london.gov.uk/dataset/london-parliamentary-constituency-profiles">https://data.london.gov.uk/dataset/london-parliamentary-constituency-profiles</a>
</div>
<div id="ref-mansournia:2020" class="csl-entry" role="listitem">
Mansournia, M. A., Nazemipour, M., Naimi, A. I., Collins, G. S., &amp; Campbell, M. J. (2020). <span class="nocase">Reflection on modern methods: demystifying robust standard errors for epidemiologists</span>. <em>International Journal of Epidemiology</em>, <em>50</em>(1), 346‚Äì351. <a href="https://doi.org/10.1093/ije/dyaa260">https://doi.org/10.1093/ije/dyaa260</a>
</div>
<div id="ref-robinson:2022" class="csl-entry" role="listitem">
Robinson, T. S. (2022). <em><span class="nocase">10 Fundamental Theorems for Econometrics</span></em>. <a href="https://bookdown.org/ts_robinson1994/10_fundamental_theorems_for_econometrics/exp-theorems.html">https://bookdown.org/ts_robinson1994/10_fundamental_theorems_for_econometrics/exp-theorems.html</a>
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This discussion is a verbatim reproduction of <span class="citation" data-cites="linke:forthcoming">Linke (forthcoming)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const buttons = document.querySelectorAll(".delayed-download");

    buttons.forEach(function (btn) {
      const releaseDate = new Date(btn.dataset.date);
      const now = new Date();

      if (now >= releaseDate) {
        btn.classList.remove("disabled");
        btn.setAttribute("aria-disabled", "false");
        btn.setAttribute("href", btn.dataset.path);
        btn.setAttribute("download", btn.dataset.path.split('/').pop());
        btn.innerHTML = btn.dataset.label || "üìÑ Download Document";
      }
    });
  });
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/drflolinke\.github\.io\/PO12Q\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./09-PO12Q.html" class="pagination-link" aria-label="Week 9">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Week 9</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11-Downloads.html" class="pagination-link" aria-label="Downloads">
        <span class="nav-page-text"><span class="chapter-title">Downloads</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>